<?phpfunction api_call($method, $url, $data, $safemode = true){	$debug = false;		if($method == 'POST'){$file = http_post($url, $data, $debug);}	else if($method == 'GET'){$file = http_get($url, $data, $debug);}	else{$file = false;}		if($file){		$result = json_decode($file, true);		$status_code = isset($result['status']['code']) ? $result['status']['code'] : null;		if($status_code == 200){			return $result;		}		else if($status_code == 402 && $safemode == true){			header('Location: 402.php?sec='.$result['info']['next_restart']); // trop de requÃªtes...			exit;		}				if($debug == true){echo '<pre>'.$file.'</pre><pre>'; print_r($result); echo '</pre>';}	}		if($safemode == true){		if($debug == true){/*echo '<pre>$file == false !!!</pre>';*/}		else{			header('Location: 404.php');			exit;		}	}}// privatefunction http_post($url, $data, $debug = false){	if(getStatus() == "LOCAL"){		$data_url = http_build_query($data);		$data_len = strlen ($data_url);		if($debug == true){			$params = '';			if($data != null){				$cpt = 0;				foreach($data as $key => $value){					if($cpt == 0){$params .= '?'.$key.'='.urlencode($value);}					else{$params .= '&'.$key.'='.urlencode($value);}					$cpt++;				}			}			echo '<pre>POST '.$url.$params.'&meth=post'.'</pre>';		}		return file_get_contents($url, false,				stream_context_create(					array(						'http'=>array(							'method'=>	'POST',							'header'=>	"Connection: close\r\n".										"Content-Type: application/x-www-form-urlencoded\r\n". 										"Content-Length: ".$data_len."\r\n",							'content'=>	$data_url						)							)				)			);	}	else{ // file_get_contents NOT ALLOWED ON WEBSERVER !!!		$params = '';		if($data != null){			$cpt = 0;			foreach($data as $key => $value){				if($cpt == 0){$params .= '?'.$key.'='.urlencode($value);}				else{$params .= '&'.$key.'='.urlencode($value);}				$cpt++;			}		}		if($debug == true){echo '<pre>POST '.$url.$params.'&meth=post'.'</pre>';}		return get_file_content($url.$params.'&meth=post');	}}// privatefunction http_get($url, $data, $debug = false){	if(getStatus() == "LOCAL"){		$params = '';		if($data != null){			$cpt = 0;			foreach($data as $key => $value){				if($cpt == 0){$params .= '?'.$key.'='.$value;}				else{$params .= '&'.$key.'='.$value;}				$cpt++;			}		}		if($debug == true){echo '<pre>GET '.$url.$params.'</pre>';}		return file_get_contents($url.$params);	}	else{ // file_get_contents NOT ALLOWED ON WEBSERVER !!!		$params = '';		if($data != null){			$cpt = 0;			foreach($data as $key => $value){				if($cpt == 0){$params .= '?'.$key.'='.urlencode($value);}				else{$params .= '&'.$key.'='.urlencode($value);}				$cpt++;			}		}		if($debug == true){echo '<pre>GET '.$url.$params.'</pre>';}		return get_file_content($url.$params);	}}function get_file_content($url){	$ch = curl_init();	curl_setopt($ch, CURLOPT_URL, $url);	curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);	$ret = curl_exec($ch);	curl_close($ch);	return $ret;}?>